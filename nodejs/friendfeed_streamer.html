<!DOCTYPE html>
<html>
	<head>
		<title>Gnostos</title>
		<script type="text/javascript">
		// INSERT EMAILID/USERNAME HERE
		</script>
	</head>
	<body>
		<img id="profileimage"/>
		<li id="twittertitle" onmousedown="togglevisibility('twitterfeed')"></li>
		<div id="twitterfeed"></div>
		<script type="text/javascript">

		function togglevisibility(obj) {
			var el = document.getElementById(obj);
			if ( el.style.display != 'none' ) {
				el.style.display = 'none';
			}
			else {
				el.style.display = '';
			}
		}
				
		function load_tweets() {
			var twittertitle = document.getElementById('twittertitle');
			twittertitle.innerHTML = "Looking up " + emailid + "...";
			if (window.XMLHttpRequest)
			{
				var xmlhttp=new XMLHttpRequest();
				xmlhttp.open("GET","/stream?email="+emailid+"&user="+username,true);
				//xmlhttp.onprogress = onXHRProgress;
				xmlhttp.onload = onXHRLoad;
				xmlhttp.onerror = onXHRError;
				//xmlhttp.onreadystatechange = gnostos.onXHRReadyStateChange;
				xmlhttp.send();
			}
		}

		function onXHRLoad(e)
		{
		    var twitterfeed = document.getElementById('twitterfeed');
		    var profileimage = document.getElementById('profileimage');
		    var twittertitle = document.getElementById('twittertitle');
		    
		    var xmlDoc = this.responseXML;
		    var titleElements = xmlDoc.getElementsByTagName("title");
		    var nicknameElements = xmlDoc.getElementsByTagName("nickname");
		   		   
			var feed = "";
		    for(var i = 0; i < titleElements.length; ++i)
		    {
		        feed += "<li>" + titleElements[i].childNodes[0].nodeValue + "</li>";
		    }
		    profileimage.setAttribute("src", "http://friendfeed-api.com/v2/picture/" + nicknameElements[0].childNodes[0].nodeValue + "?size=medium");
		    twittertitle.innerHTML = "Twitter";
		    twitterfeed.innerHTML = feed;
		}

		function onXHRError(e)
		{
		}
				
		//setTimeout(load_tweets, 1000);
		load_tweets();
		</script>
	</body>
</html>
